name: Erlang CI

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

permissions:
  contents: read

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3
    - name: Setup Erlang
      uses: erlef/setup-erlang@v1
      with:
        otp-version: 22.0.7
    - name: Install rebar3
      run: |
        wget https://github.com/erlang/rebar3/releases/download/3.16.1/rebar3 && chmod +x rebar3
        sudo mv rebar3 /usr/local/bin/
    - name: List files
      run: ls -al
    - name: Compile
      run: rebar3 compile
    - name: Run reverse_polish_notation_evaluator
      run: erl -noshell -pa _build/default/lib/reverse_polish_notation_evaluator/ebin -s reverse_polish_notation_evaluator start -s init stop
      